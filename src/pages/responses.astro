---
// src/pages/responses.astro
import Base from "../layouts/Base.astro";
import { responses } from "../data/responses";
---

<Base title="Response Library" description="Copy-ready responses for client outreach">
  <section class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 py-10">
    <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight text-slate-800 mb-8">
      Response Library
    </h1>

    <div class="space-y-8">
      {responses.map((r, idx) => (
        <article class="rounded-xl border border-slate-200 bg-white shadow-sm">
          <header class="px-5 pt-5">
            <h2 class="text-2xl font-semibold text-slate-800">{r.title}</h2>
          </header>

          <div class="px-5 pb-5">
            <textarea
              class="mt-4 w-full h-56 rounded-md border border-slate-200 bg-slate-50 p-4 font-mono text-[15px] leading-7 text-slate-900"
              readonly
              id={`resp-${idx}`}
            >{r.body}</textarea>

            <button
              class="mt-4 inline-flex items-center rounded-md bg-blue-600 px-5 py-3 text-white font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400"
              data-idx={idx}
              aria-label={`Copy ${r.title}`}
            >
              Copy
            </button>
          </div>
        </article>
      ))}
    </div>
  </section>

  <script>
    // Copy handlers for each button
    document.querySelectorAll("button[data-idx]").forEach((btn) => {
      btn.addEventListener("click", async () => {
        const idx = btn.getAttribute("data-idx");
        const ta = document.getElementById(`resp-\${idx}`) as HTMLTextAreaElement | null;
        if (!ta) return;

        try {
          await navigator.clipboard.writeText(ta.value);
          const prev = btn.textContent;
          btn.textContent = "Copied!";
          setTimeout(() => (btn.textContent = prev), 1200);
        } catch {
          // Fallback
          ta.select();
          document.execCommand("copy");
          const prev = btn.textContent;
          btn.textContent = "Copied!";
          setTimeout(() => (btn.textContent = prev), 1200);
        }
      });
    });
  </script>
</Base>
