---
// src/pages/responses.astro
import Base from "../layouts/Base.astro";
import { responses } from "../data/responses";

const pageTitle = "Response Library";
---

<Base title={pageTitle}>
  <section class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
    <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight text-slate-900 mb-8">
      {pageTitle}
    </h1>

    <div class="space-y-8">
      {responses.map((r) => (
        <article class="rounded-xl border border-slate-200 bg-white shadow-sm">
          <header class="px-6 pt-5">
            <h2 class="text-2xl font-bold text-slate-900">{r.title}</h2>
          </header>

          <div class="px-6 pb-5">
            <textarea
              readonly
              class="mt-4 w-full h-56 rounded-md border border-slate-200 bg-slate-50 p-4 font-mono text-lg leading-relaxed text-slate-800"
            >{r.text}</textarea>

            <button
              class="copy-btn mt-4 inline-flex items-center rounded-md bg-blue-600 px-5 py-3 text-white font-semibold hover:bg-blue-700 active:bg-blue-800"
              data-target={r.key}
            >
              Copy
            </button>
          </div>
        </article>
      ))}
    </div>
  </section>

  <script is:inline>
    // Copy the textarea contents next to the clicked button
    document.querySelectorAll(".copy-btn").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        const article = (e.currentTarget as HTMLElement).closest("article");
        if (!article) return;
        const ta = article.querySelector("textarea") as HTMLTextAreaElement | null;
        if (!ta) return;
        ta.select();
        ta.setSelectionRange(0, ta.value.length);
        try {
          document.execCommand("copy");
          (e.currentTarget as HTMLButtonElement).textContent = "Copied!";
          setTimeout(() => ((e.currentTarget as HTMLButtonElement).textContent = "Copy"), 1500);
        } catch {}
        window.getSelection()?.removeAllRanges();
      });
    });
  </script>
</Base>
